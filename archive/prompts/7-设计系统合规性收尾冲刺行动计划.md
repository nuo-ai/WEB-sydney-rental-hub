# AI Prompt: 设计系统合规性收尾冲刺行动计划

## 1. 角色 (Persona)

**你是一位经验丰富的 ****高级前端工程师** 和  **设计系统架构师** **，以注重细节和追求代码质量而闻名。你正在指导我完成一个项目的最后阶段：对一个已经大规模令牌化的 Vue 3 应用进行最终的清理和统一，确保其 100% 符合既定的设计系统规范。**

## 2. 项目上下文 (Context)

**我正在开发一个名为“** **JUWO 桔屋找房** **”的应用。我们已经取得了巨大的成功：**

* **设计系统已全面建立** **: 我们定义了成熟的颜色、文字、间距等 Design Tokens。**
* **核心流程已改造** **: 列表页、详情页、筛选、通勤等核心用户路径已基本完成令牌化和 i18n 改造。**
* **自动化护栏已生效** **: Stylelint 和 pre-commit hook 正在有效地阻止新的硬编码样式进入代码库。**

 **当前状态** **: 项目已完成约 85% 的设计系统迁移。剩下的工作不是开创新功能，而是**“查漏补缺”的收尾工作**，旨在解决 **`<span class="selected">activeContext.md</span>` 中列出的 `<span class="selected">[P1]</span>` 和 `<span class="selected">[P2]</span>` 级别的遗留问题。

## 3. 核心任务 (Task)

**你的核心任务是，为我提供一份** **详尽的、分步的、可立即执行的行动计划** **，指导我完成本次“设计系统合规性收尾”冲刺。这份计划需要像一份“质量验收清单”一样清晰，涵盖所有需要清理和统一的具体工作项。**

## 4. 关键原则与约束 (Principles & Constraints)

* **零容忍** **: 本次冲刺的目标是彻底清除所有已知的、不符合规范的模式。**
* **一致性** **: 严格遵循已建立的设计系统和 **`<span class="selected">systemPatterns.md</span>` 中的规范。
* **可维护性** **: 所有改动的最终目的都是为了提升代码的长期可维护性和可读性。**

## 5. 期望的输出格式 (Output Format)

**请严格按照以下结构化的冲刺任务清单来组织你的回复，确保方案的完整性和可操作性。**

### **“设计系统合规性收尾”冲刺任务清单**

#### **任务一: [P1] 令牌定义梳理与清理**

* **目标** **: 清理令牌定义文件中的历史遗留问题，明确“官方”令牌，废弃“老旧”令牌。**
* **具体步骤** **:**

1. **审计令牌文件** **: 仔细检查 **`<span class="selected">src/style.css</span>` 和 `<span class="selected">src/styles/design-tokens.css</span>`。
2. **识别废弃令牌** **: 找到所有已被新的语义令牌所取代的旧令牌（例如: **`<span class="selected">--color-accent</span>`, `<span class="selected">--font-size-base</span>`, `<span class="selected">--spacing-lg</span>`）。
3. **标记为 `<span class="selected">@deprecated</span>`** **: 不要立即删除这些旧令牌。在它们上方添加明确的注释，标记它们为“已废弃”，并指出应该使用哪个新令牌来替代。**

* **“操作手册” - Before & After 示例** **:**
  **Before: “坏代码”**

```
  :root {
    /* ... */
    --color-accent: var(--brand-primary); /* 这是一个旧的、语义模糊的令牌 */
  }

```

  **After: “好代码”**

```
  :root {
    /* ... */
    /**
     * @deprecated --color-accent is deprecated since 2025-09-11. 
     * Please use '--brand-primary' for CTAs or '--color-border-strong' for focused borders instead.
     */
    --color-accent: var(--brand-primary); 
  }

```

#### **任务二: [P1] 图标系统完全统一**

* **目标** **: 确保项目中使用的所有图标都来自唯一的图标库 (**`<span class="selected">lucide-vue-next</span>`)，并遵循统一的样式规范。
* **具体步骤** **:**

1. **全局扫描** **: 在代码编辑器中，全局搜索旧的图标库用法（如 **`<span class="selected">Font Awesome</span>` 的 `<span class="selected"><i></span>` 标签或 `<span class="selected"><font-awesome-icon></span>` 组件）以及任何对 `<span class="selected">src/components/icons/</span>` 目录的引用。
2. **逐个替换** **: 将所有找到的旧图标，替换为对应的 **`<span class="selected">lucide-vue-next</span>` 组件。
3. **强制 `<span class="selected">currentColor</span>`** **: 检查并确保所有替换后的 **`<span class="selected"><IconName /></span>` 组件都**没有**硬编码的 `<span class="selected">color</span>`, `<span class="selected">fill</span>`, `<span class="selected">stroke</span>` 属性。它们的颜色必须由其父元素的 `<span class="selected">color</span>` CSS 属性通过 `<span class="selected">currentColor</span>` 来继承。

* **“操作手册” - Before & After 示例** **:**
  **Before: “坏代码”**

```
  <!-- MyComponent.vue -->
  <template>
    <div class="info-line">
      <i class="fas fa-bed" style="color: #6B7280;"></i> <!-- Font Awesome with inline style -->
      <span>3</span>
    </div>
  </template>

```

  **After: “好代码”**

```
  <!-- MyComponent.vue -->
  <template>
    <div class="info-line text-secondary"> <!-- Color is controlled by parent class -->
      <Bed class="spec-icon" /> <!-- Lucide icon, inherits color via currentColor -->
      <span class="typo-body-default">3</span>
    </div>
  </template>

  <style scoped>
  .info-line {
    /* The color is set here for both text and icon */
    color: var(--color-text-secondary); 
    display: flex;
    align-items: center;
    gap: var(--space-1);
  }
  </style>

```

#### **任务三: [P2] 移除所有样式兜底 (Fallback)**

* **目标** **: 彻底清除代码中所有 **`<span class="selected">var()</span>` 函数的十六进制或 `<span class="selected">rgb</span>` 兜底值，增强我们对设计系统的信心和系统的健壮性。
* **具体步骤** **:**

1. **全局搜索** **: 使用正则表达式在整个项目中（**`<span class="selected">.vue</span>` 和 `<span class="selected">.css</span>` 文件）搜索 `<span class="selected">var\(--[^,]+,\s*#[0-9a-fA-F]+\)</span>` 以及 `<span class="selected">var\(--[^,]+,\s*rgb</span>`。
2. **逐个移除** **: 将所有找到的 **`<span class="selected">var(--my-token, #fallback)</span>` 形式的用法，简化为干净的 `<span class="selected">var(--my-token)</span>`。
3. **验证** **: 如果移除后样式丢失，这说明 **`<span class="selected">--my-token</span>` 可能定义不正确或未被正确引入。此时应该去修复令牌的定义，而不是把兜底加回来。

* **“操作手册” - Before & After 示例** **:**
  **Before: “坏代码”**

```
  /* SomeComponent.vue */
  .chip {
    background-color: var(--chip-bg, #f3f4f6);
    border: 1px solid var(--chip-border-color, #d1d5db);
  }

```

  **After: “好代码”**

```
  /* SomeComponent.vue */
  .chip {
    background-color: var(--chip-bg);
    border: 1px solid var(--chip-border-color);
  }

```

### **第三部分：验收标准 (Acceptance Criteria)**

**本次冲刺完成的标志是：**

* **[ ] ** **代码库中** **：**
  * **[ ] 所有已知的废弃令牌都已被正确标记 **`<span class="selected">@deprecated</span>`。
  * **[ ] 全局搜索 **`<span class="selected">fas</span>`, `<span class="selected">far</span>`, `<span class="selected">fa-</span>`, `<span class="selected">font-awesome-icon</span>`, `<span class="selected">components/icons/</span>` 等关键词，返回 0 个结果。
  * **[ ] 全局搜索 **`<span class="selected">var(--*, #</span>` 和 `<span class="selected">var(--*, rgb</span>`，在**组件和页面代码**中返回 0 个结果。
* **前端表现中** **：**
* **[ ] 应用的所有页面视觉表现与冲刺前** **完全一致** **，没有出现样式回归。**
* **[ ] 所有图标风格、大小、颜色完全统一。**
* **[ ] 在未来切换主题（如深色模式）时，不会有任何元素“顽固地”保持着旧的硬编码颜色。**

**请开始执行这份收尾冲刺计划。**
